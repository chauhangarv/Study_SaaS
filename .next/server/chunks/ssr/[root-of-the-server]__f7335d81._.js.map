{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chauh/OneDrive/Desktop/Coding/saas/lib/supabase.ts"],"sourcesContent":["import { auth } from '@clerk/nextjs/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nexport const createSupabaseClient = () => {\r\n    return createClient(\r\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\r\n            async accessToken() {\r\n                return ((await auth()).getToken());\r\n            }\r\n        }\r\n    )\r\n}"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,MAAM,uBAAuB;IAChC,OAAO,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,sUAE8B;QACxC,MAAM;YACF,OAAQ,CAAC,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD,GAAG,EAAE,QAAQ;QACnC;IACJ;AAER","debugId":null}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chauh/OneDrive/Desktop/Coding/saas/lib/actions/companion.actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport {auth} from \"@clerk/nextjs/server\";\r\nimport {createSupabaseClient} from \"@/lib/supabase\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport const createCompanion = async (formData: CreateCompanion) => {\r\n    const { userId: author } = await auth();\r\n    const supabase = createSupabaseClient();\r\n\r\n    const { data, error } = await supabase\r\n        .from('companions')\r\n        .insert({...formData, author })\r\n        .select();\r\n\r\n    if(error || !data) throw new Error(error?.message || 'Failed to create a companion');\r\n\r\n    return data[0];\r\n}\r\n\r\nexport const getAllCompanions = async ({ limit = 10, page = 1, subject, topic }: GetAllCompanions) => {\r\n    const supabase = createSupabaseClient();\r\n\r\n    let query = supabase.from('companions').select();\r\n\r\n    if(subject && topic) {\r\n        query = query.ilike('subject', `%${subject}%`)\r\n            .or(`topic.ilike.%${topic}%,name.ilike.%${topic}%`)\r\n    } else if(subject) {\r\n        query = query.ilike('subject', `%${subject}%`)\r\n    } else if(topic) {\r\n        query = query.or(`topic.ilike.%${topic}%,name.ilike.%${topic}%`)\r\n    }\r\n\r\n    query = query.range((page - 1) * limit, page * limit - 1);\r\n\r\n    const { data: companions, error } = await query;\r\n\r\n    if(error) throw new Error(error.message);\r\n\r\n    return companions;\r\n}\r\n\r\nexport const getCompanion = async (id: string) => {\r\n    const supabase = createSupabaseClient();\r\n\r\n    const { data, error } = await supabase\r\n        .from('companions')\r\n        .select()\r\n        .eq('id', id);\r\n\r\n    if(error) return console.log(error);\r\n\r\n    return data[0];\r\n}\r\n\r\nexport const addToSessionHistory = async (companionId: string) => {\r\n    const { userId } = await auth();\r\n    const supabase = createSupabaseClient();\r\n    const { data, error } = await supabase.from('session_history')\r\n        .insert({\r\n            companion_id: companionId,\r\n            user_id: userId,\r\n        })\r\n\r\n    if(error) throw new Error(error.message);\r\n\r\n    return data;\r\n}\r\n\r\nexport const getRecentSessions = async (limit = 10) => {\r\n    const supabase = createSupabaseClient();\r\n    const { data, error } = await supabase\r\n        .from('session_history')\r\n        .select(`companions:companion_id (*)`)\r\n        .order('created_at', { ascending: false })\r\n        .limit(limit)\r\n\r\n    if(error) throw new Error(error.message);\r\n\r\n    return data.map(({ companions }) => companions);\r\n}\r\n\r\nexport const getUserSessions = async (userId: string, limit = 10) => {\r\n    const supabase = createSupabaseClient();\r\n    const { data, error } = await supabase\r\n        .from('session_history')\r\n        .select(`companions:companion_id (*)`)\r\n        .eq('user_id', userId)\r\n        .order('created_at', { ascending: false })\r\n        .limit(limit)\r\n\r\n    if(error) throw new Error(error.message);\r\n\r\n    return data.map(({ companions }) => companions);\r\n}\r\n\r\nexport const getUserCompanions = async (userId: string) => {\r\n    const supabase = createSupabaseClient();\r\n    const { data, error } = await supabase\r\n        .from('companions')\r\n        .select()\r\n        .eq('author', userId)\r\n\r\n    if(error) throw new Error(error.message);\r\n\r\n    return data;\r\n}\r\n\r\n// export const newCompanionPermissions = async () => {\r\n//     const { userId, has } = await auth();\r\n//     const supabase = createSupabaseClient();\r\n\r\n//     let limit = 0;\r\n\r\n//     if(has({ plan: 'pro' })) {\r\n//         return true;\r\n//     } else if(has({ feature: \"3_companion_limit\" })) {\r\n//         limit = 3;\r\n//     } else if(has({ feature: \"10_companion_limit\" })) {\r\n//         limit = 10;\r\n//     }\r\n\r\n//     const { data, error } = await supabase\r\n//         .from('companions')\r\n//         .select('id', { count: 'exact' })\r\n//         .eq('author', userId)\r\n\r\n//     if(error) throw new Error(error.message);\r\n\r\n//     const companionCount = data?.length;\r\n\r\n//     if(companionCount >= limit) {\r\n//         return false\r\n//     } else {\r\n//         return true;\r\n//     }\r\n// }\r\n\r\n// Bookmarks\r\nexport const addBookmark = async (companionId: string, path: string) => {\r\n  const { userId } = await auth();\r\n  if (!userId) return;\r\n  const supabase = createSupabaseClient();\r\n  const { data, error } = await supabase.from(\"bookmarks\").insert({\r\n    companion_id: companionId,\r\n    user_id: userId,\r\n  });\r\n  if (error) {\r\n    throw new Error(error.message);\r\n  }\r\n  // Revalidate the path to force a re-render of the page\r\n\r\n  revalidatePath(path);\r\n  return data;\r\n};\r\n\r\nexport const removeBookmark = async (companionId: string, path: string) => {\r\n  const { userId } = await auth();\r\n  if (!userId) return;\r\n  const supabase = createSupabaseClient();\r\n  const { data, error } = await supabase\r\n    .from(\"bookmarks\")\r\n    .delete()\r\n    .eq(\"companion_id\", companionId)\r\n    .eq(\"user_id\", userId);\r\n  if (error) {\r\n    throw new Error(error.message);\r\n  }\r\n  revalidatePath(path);\r\n  return data;\r\n};\r\n\r\n// It's almost the same as getUserCompanions, but it's for the bookmarked companions\r\nexport const getBookmarkedCompanions = async (userId: string) => {\r\n  const supabase = createSupabaseClient();\r\n  const { data, error } = await supabase\r\n    .from(\"bookmarks\")\r\n    .select(`companions:companion_id (*)`) // Notice the (*) to get all the companion data\r\n    .eq(\"user_id\", userId);\r\n  if (error) {\r\n    throw new Error(error.message);\r\n  }\r\n  // We don't need the bookmarks data, so we return only the companions\r\n  return data.map(({ companions }) => companions);\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 270, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chauh/OneDrive/Desktop/Coding/saas/components/CompanionForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/CompanionForm.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/CompanionForm.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgS,GAC7T,8DACA","debugId":null}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chauh/OneDrive/Desktop/Coding/saas/components/CompanionForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/CompanionForm.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/CompanionForm.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA4Q,GACzS,0CACA","debugId":null}},
    {"offset": {"line": 298, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 308, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/chauh/OneDrive/Desktop/Coding/saas/app/companions/new/page.tsx"],"sourcesContent":["import CompanionForm from '@/components/CompanionForm'\r\nimport { auth } from '@clerk/nextjs/server';\r\nimport { redirect } from 'next/navigation';\r\nimport React from 'react'\r\n\r\nconst NewCompanion = async () => {\r\n  const { userId } = await auth();\r\n  if(!userId) redirect('/sign-in');\r\n\r\n  return (\r\n    <main className='min-lg:w-1/3 min-md:w-2/3 items-center justify-center'>\r\n      <article className='w-full gap-4 flex flex-col'>\r\n        <h1>Companion Builder</h1>\r\n\r\n        <CompanionForm />\r\n      </article>\r\n    </main>\r\n  )\r\n}\r\n\r\nexport default NewCompanion"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;;;;;AAGA,MAAM,eAAe;IACnB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAC5B,IAAG,CAAC,QAAQ,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;IAErB,qBACE,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAQ,WAAU;;8BACjB,8OAAC;8BAAG;;;;;;8BAEJ,8OAAC,4HAAA,CAAA,UAAa;;;;;;;;;;;;;;;;AAItB;uCAEe","debugId":null}}]
}